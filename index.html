<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaTracker - Water Filter Manager</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Track your water filter replacements with smart notifications">
    <meta name="theme-color" content="#218085">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="AquaTracker">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzIxODA4NSIvPgo8dGV4dCB4PSIxNiIgeT0iMjAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+üíß</dGV4dD4KPC9zdmc+">
    
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">üíß</div>
                <h1 class="app-title">AquaTracker</h1>
            </div>
            <div class="header-controls">
                <button id="notification-toggle" class="icon-btn" title="Toggle Notifications">
                    <span class="notification-icon">üîï</span>
                </button>
                
                <!-- Theme Toggle Switch -->
                <div class="theme-toggle-container">
                    <label class="theme-switch">
                        <input type="checkbox" id="theme-toggle">
                        <span class="slider">
                            <span class="slider-icon sun">‚òÄÔ∏è</span>
                            <span class="slider-icon moon">üåô</span>
                        </span>
                    </label>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="tab-navigation">
        <div class="container">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="dashboard">
                    <span class="tab-icon">üè†</span>
                    <span class="tab-label">Dashboard</span>
                </button>
                <button class="tab-btn" data-tab="history">
                    <span class="tab-icon">üìã</span>
                    <span class="tab-label">History</span>
                </button>
                <button class="tab-btn" data-tab="statistics">
                    <span class="tab-icon">üìä</span>
                    <span class="tab-label">Statistics</span>
                </button>
                <button class="tab-btn" data-tab="settings">
                    <span class="tab-icon">‚öôÔ∏è</span>
                    <span class="tab-label">Settings</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-filters">7</div>
                        <div class="stat-label">Total Filters</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number overdue" id="overdue-filters">3</div>
                        <div class="stat-label">Overdue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number due-soon" id="due-soon-filters">1</div>
                        <div class="stat-label">Due Soon</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number good" id="good-filters">3</div>
                        <div class="stat-label">Good</div>
                    </div>
                </div>

                <!-- Action Bar -->
                <div class="action-bar">
                    <input type="text" id="search-input" placeholder="Search filters..." class="search-input">
                    <button id="add-filter-btn" class="btn btn-primary">
                        <span>‚ûï</span> Add Filter
                    </button>
                </div>

                <!-- Filters Grid -->
                <div id="filters-grid" class="filters-grid">
                    <!-- Filters will be rendered here -->
                </div>
            </div>

            <!-- History Tab -->
            <div id="history-tab" class="tab-content">
                <div class="section-header">
                    <h2>Replacement History</h2>
                    <div class="header-actions">
                        <button id="export-history" class="btn btn-secondary btn-sm">
                            <span>üì•</span> Export
                        </button>
                        <button id="clear-history" class="btn btn-outline btn-sm">
                            <span>üóëÔ∏è</span> Clear
                        </button>
                    </div>
                </div>
                
                <div class="history-filters">
                    <select id="history-filter" class="form-control">
                        <option value="all">All Filters</option>
                        <option value="30">Last 30 Days</option>
                        <option value="90">Last 90 Days</option>
                        <option value="365">Last Year</option>
                    </select>
                </div>

                <div id="history-list" class="history-list">
                    <!-- History items will be rendered here -->
                </div>
            </div>

            <!-- Statistics Tab -->
            <div id="statistics-tab" class="tab-content">
                <div class="section-header">
                    <h2>Statistics & Insights</h2>
                </div>

                <!-- Cost Statistics -->
                <div class="stats-section">
                    <h3>üí∞ Cost Analysis</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="total-cost">ÿ¨.ŸÖ 3,920</div>
                            <div class="stat-label">Total Spent</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avg-cost">ÿ¨.ŸÖ 560</div>
                            <div class="stat-label">Average Cost</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="monthly-cost">ÿ¨.ŸÖ 672</div>
                            <div class="stat-label">Monthly Average</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="yearly-projection">ÿ¨.ŸÖ 8,064</div>
                            <div class="stat-label">Yearly Projection</div>
                        </div>
                    </div>
                </div>

                <!-- Environmental Impact -->
                <div class="stats-section">
                    <h3>üå± Environmental Impact</h3>
                    <div class="impact-grid">
                        <div class="impact-card">
                            <div class="impact-icon">üíß</div>
                            <div class="impact-content">
                                <div class="impact-number" id="bottles-saved">4,800</div>
                                <div class="impact-label">Plastic Bottles Saved</div>
                            </div>
                        </div>
                        <div class="impact-card">
                            <div class="impact-icon">üåç</div>
                            <div class="impact-content">
                                <div class="impact-number" id="co2-saved">96 lbs</div>
                                <div class="impact-label">CO‚ÇÇ Reduced</div>
                            </div>
                        </div>
                        <div class="impact-card">
                            <div class="impact-icon">‚ôªÔ∏è</div>
                            <div class="impact-content">
                                <div class="impact-number" id="waste-reduced">19 lbs</div>
                                <div class="impact-label">Plastic Waste Reduced</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filter Performance -->
                <div class="stats-section">
                    <h3>üìà Filter Performance</h3>
                    <div class="performance-list" id="performance-list">
                        <!-- Performance items will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="section-header">
                    <h2>Settings</h2>
                </div>

                <div class="settings-section">
                    <h3>üîî Notification Defaults</h3>
                    <div class="form-group">
                        <label for="default-buy-reminder">Default Buy Reminder</label>
                        <select id="default-buy-reminder" class="form-control">
                            <option value="7">1 week before</option>
                            <option value="14" selected>2 weeks before</option>
                            <option value="21">3 weeks before</option>
                            <option value="30">1 month before</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="default-replace-reminder">Default Replace Reminder</label>
                        <select id="default-replace-reminder" class="form-control">
                            <option value="1">1 day before</option>
                            <option value="3">3 days before</option>
                            <option value="7" selected>1 week before</option>
                            <option value="14">2 weeks before</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>üé® Appearance</h3>
                    <div class="form-group">
                        <label for="currency-select">Currency</label>
                        <select id="currency-select" class="form-control">
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (‚Ç¨)</option>
                            <option value="GBP">GBP (¬£)</option>
                            <option value="CAD">CAD ($)</option>
                            <option value="EGP" selected>EGP (ÿ¨.ŸÖ)</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>üì± Data Management</h3>
                    <div class="settings-actions">
                        <button id="export-data" class="btn btn-primary">
                            <span>üì§</span> Export All Data
                        </button>
                        <button id="import-data" class="btn btn-secondary">
                            <span>üì•</span> Import Data
                        </button>
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                        <button id="reset-data" class="btn btn-danger">
                            <span>üóëÔ∏è</span> Reset All Data
                        </button>
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <!-- Filter Modal with Advanced Notifications -->
    <div id="filter-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Add Filter</h2>
                <button class="modal-close" id="modal-close-filter">&times;</button>
            </div>
            <form id="filter-form" class="modal-body">
                <div class="form-group">
                    <label for="filter-name">Filter Name *</label>
                    <input type="text" id="filter-name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="filter-location">Location *</label>
                        <input type="text" id="filter-location" required>
                    </div>
                    <div class="form-group">
                        <label for="filter-stage">Stage</label>
                        <input type="text" id="filter-stage" placeholder="e.g., Stage 1">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="filter-type">Type *</label>
                        <select id="filter-type" required>
                            <option value="">Select Type</option>
                            <option value="Sediment">Sediment</option>
                            <option value="Carbon">Carbon</option>
                            <option value="Carbon Block">Carbon Block</option>
                            <option value="RO Membrane">RO Membrane</option>
                            <option value="Post Carbon">Post Carbon</option>
                            <option value="Mineral">Mineral</option>
                            <option value="UV Lamp">UV Lamp</option>
                            <option value="Whole House">Whole House</option>
                            <option value="Pitcher">Pitcher</option>
                            <option value="Faucet Mount">Faucet Mount</option>
                            <option value="Shower">Shower</option>
                            <option value="Refrigerator">Refrigerator</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="filter-interval">Replace Every (months) *</label>
                        <select id="filter-interval" required>
                            <option value="3">3 months</option>
                            <option value="6">6 months</option>
                            <option value="9">9 months</option>
                            <option value="12">12 months</option>
                            <option value="18">18 months</option>
                            <option value="24">24 months</option>
                            <option value="36">36 months</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="filter-brand">Brand</label>
                        <input type="text" id="filter-brand">
                    </div>
                    <div class="form-group">
                        <label for="filter-model">Model</label>
                        <input type="text" id="filter-model">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="filter-install-date">Install Date *</label>
                        <input type="date" id="filter-install-date" required>
                    </div>
                    <div class="form-group">
                        <label for="filter-cost">Cost (EGP)</label>
                        <input type="number" id="filter-cost" min="0" step="0.01">
                    </div>
                </div>

                <!-- Advanced Notification Settings -->
                <div class="notification-settings">
                    <h4>üîî Advanced Notification Settings</h4>
                    
                    <!-- Buy Reminders -->
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="buy-reminder-enabled" checked>
                            <span>Enable Buy Reminders</span>
                        </label>
                    </div>
                    
                    <div class="buy-reminder-settings" id="buy-reminder-settings">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="buy-reminder-timing">When to remind</label>
                                <select id="buy-reminder-timing">
                                    <option value="1">1 day before</option>
                                    <option value="3">3 days before</option>
                                    <option value="7">1 week before</option>
                                    <option value="14" selected>2 weeks before</option>
                                    <option value="21">3 weeks before</option>
                                    <option value="30">1 month before</option>
                                    <option value="60">2 months before</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="buy-reminder-frequency">Repeat frequency</label>
                                <select id="buy-reminder-frequency">
                                    <option value="once">Once only</option>
                                    <option value="daily">Daily</option>
                                    <option value="every-3-days">Every 3 days</option>
                                    <option value="weekly" selected>Weekly</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="buy-reminder-time">Time of day</label>
                                <input type="time" id="buy-reminder-time" value="09:00">
                            </div>
                            <div class="form-group">
                                <label for="buy-stop-days">Stop reminding after</label>
                                <select id="buy-stop-days">
                                    <option value="0">Never stop</option>
                                    <option value="3">3 days</option>
                                    <option value="7" selected>1 week</option>
                                    <option value="14">2 weeks</option>
                                    <option value="30">1 month</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Replace Reminders -->
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="replace-reminder-enabled" checked>
                            <span>Enable Replace Reminders</span>
                        </label>
                    </div>
                    
                    <div class="replace-reminder-settings" id="replace-reminder-settings">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="replace-reminder-timing">When to remind</label>
                                <select id="replace-reminder-timing">
                                    <option value="0">On due date</option>
                                    <option value="1" selected>1 day before</option>
                                    <option value="3">3 days before</option>
                                    <option value="7">1 week before</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="replace-reminder-frequency">Repeat frequency</label>
                                <select id="replace-reminder-frequency">
                                    <option value="once">Once only</option>
                                    <option value="daily" selected>Daily</option>
                                    <option value="twice-daily">Twice daily (All day)</option>
                                    <option value="every-2-hours">Every 2 hours</option>
                                    <option value="every-hour">Every hour</option>
                                    <option value="every-30-min">Every 30 minutes</option>
                                    <option value="every-15-min">Every 15 minutes</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="replace-reminder-time">Time of day</label>
                                <input type="time" id="replace-reminder-time" value="10:00">
                            </div>
                            <div class="form-group">
                                <label for="overdue-escalation">When overdue</label>
                                <select id="overdue-escalation">
                                    <option value="none">No change</option>
                                    <option value="every-hour">Every hour</option>
                                    <option value="every-2-hours" selected>Every 2 hours</option>
                                    <option value="every-6-hours">Every 6 hours</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Critical Overdue Alerts -->
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="critical-reminder-enabled">
                            <span>Enable Critical Overdue Alerts</span>
                        </label>
                    </div>
                    
                    <div class="critical-reminder-settings" id="critical-reminder-settings" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="critical-threshold">Consider critical after</label>
                                <select id="critical-threshold">
                                    <option value="7">1 week overdue</option>
                                    <option value="14" selected>2 weeks overdue</option>
                                    <option value="21">3 weeks overdue</option>
                                    <option value="30">1 month overdue</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="critical-frequency">Alert frequency</label>
                                <select id="critical-frequency">
                                    <option value="every-15-min">Every 15 minutes</option>
                                    <option value="every-30-min">Every 30 minutes</option>
                                    <option value="hourly" selected>Every hour</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="filter-notes">Notes</label>
                    <textarea id="filter-notes" rows="3" placeholder="Additional notes about this filter..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Filter</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirm Action</h2>
                <button class="modal-close" id="modal-close-confirm">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message">Are you sure?</p>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="confirm-cancel">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirm-ok">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Permission Modal -->
    <div id="notification-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîî Enable Notifications</h2>
                <button class="modal-close" id="modal-close-notification">&times;</button>
            </div>
            <div class="modal-body">
                <p>Get reminded when your water filters need replacement!</p>
                <ul>
                    <li>‚Ä¢ Buy reminders before filters expire</li>
                    <li>‚Ä¢ Replace reminders when due</li>
                    <li>‚Ä¢ Overdue alerts for immediate action</li>
                    <li>‚Ä¢ Custom timing and frequency for each filter</li>
                </ul>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="notification-cancel">Not Now</button>
                    <button type="button" class="btn btn-primary" id="notification-enable">Enable Notifications</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Install Prompt -->
    <div id="install-prompt" class="install-banner" style="display: none;">
        <div class="install-content">
            <span>üì± Install AquaTracker for offline access and notifications</span>
            <div class="install-actions">
                <button id="install-btn" class="btn btn-primary btn-sm">Install</button>
                <button id="install-dismiss" class="btn btn-secondary btn-sm">Later</button>
            </div>
        </div>
    </div>

    <script src="./app.js"></script>
</body>
</html>